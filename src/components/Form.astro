---
const currentPath = Astro.url.pathname;
---

<div class="nav-select-wrapper">
  <select 
    class="nav-select"
    aria-label="Navigation menu"
  >
    <option value="/" selected={currentPath === "/"}>Home</option>
    <option value="/badges" selected={currentPath === "/badges"}>Badges</option>
    <option value="/blogs" selected={currentPath === "/blogs"}>Blogs</option>
  </select>
</div>

<style>
  .nav-select-wrapper {
    position: fixed;
    top: 1rem;
    left: 1rem;
    z-index: 100;
  }

  .nav-select {
    appearance: none;
    background-color: white;
    border: 1px solid #ccc;
    border-radius: 0.5rem;
    padding: 0.5rem 2.5rem 0.5rem 1rem;
    font-size: 1rem;
    cursor: pointer;
    min-width: 150px;
    color: #333;
  }

  .nav-select-wrapper::after {
    content: 'â–¼';
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    color: #666;
  }

  /* Hover and Focus states */
  .nav-select:hover {
    border-color: #666;
  }

  .nav-select:focus {
    outline: none;
    border-color: #4a90e2;
    box-shadow: 0 0 0 2px rgba(74, 144, 226, 0.2);
  }

  /* Dark mode */
  :global(html.dark) .nav-select {
    background-color: #1a1a1a;
    border-color: #444;
    color: #fff;
  }

  :global(html.dark) .nav-select-wrapper::after {
    color: #888;
  }

  :global(html.dark) .nav-select:hover {
    border-color: #666;
  }
</style>

<script>
  function handleNavigation() {
    const select = document.querySelector('.nav-select');
    if (!select) return;

    // Set initial value
    select.value = window.location.pathname;

    select.addEventListener('change', async (event) => {
      const target = event.target as HTMLSelectElement;
      if (!target) return;

      try {
        const url = new URL(target.value, window.location.origin);
        window.location.href = url.toString();
      } catch (error) {
        console.error('Navigation failed:', error);
        select.value = window.location.pathname;
      }
    });
  }

  // Initialize navigation
  document.addEventListener('DOMContentLoaded', handleNavigation);
  document.addEventListener('astro:page-load', handleNavigation);
</script>
